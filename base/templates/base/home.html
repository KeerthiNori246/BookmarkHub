{% extends 'main.html' %}

{% block content %}

<div class="container" style="max-width: 1200px; padding: 40px 20px; font-family: 'Futura', Arial, sans-serif;">

  <h2 style="font-size: 28px; font-weight: bold; margin-bottom: 30px; letter-spacing: 1px;">
    Hi {{ request.user.name }}!!
  </h2>

  <!-- 🔍 Search Bar -->
  <form method="get" action="{% url 'home' %}" style="display: flex; gap: 10px; margin-bottom: 30px;">
    <input 
      type="text" 
      name="q" 
      placeholder="Explore topics that excite you...."
      value="{{ request.GET.q|default:'' }}"
      style="flex: 1; padding: 10px 14px; border: 1px solid #ccc; border-radius: 4px; font-size: 16px;">
    <button type="submit" 
            style="background: black; color: white; padding: 10px 18px; border: none; border-radius: 4px; cursor: pointer; font-weight: 500;">
      Search
    </button>
  </form>

  <!-- ⬅️ Back Button -->
  {% if request.GET.q %}
    <div style="margin-bottom: 20px;">
      <a href="{% url 'home' %}" 
         style="background: #f5f5f5; color: black; padding: 8px 14px; border-radius: 4px; text-decoration: none; font-size: 15px;">
        ⬅ Back
      </a>
    </div>
  {% endif %}

  <div class="row" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 30px;">
    {% for article in article_data %}
      <div style="border: 1px solid #ddd; border-radius: 6px; overflow: hidden; display: flex; flex-direction: column;">

        {% if article.pic %}
          <img src="{{ article.pic }}" alt="{{ article.title }}" 
               style="width: 100%; height: 200px; object-fit: cover;">
        {% else %}
          <div style="width: 100%; height: 200px; background: #f5f5f5; display: flex; align-items: center; justify-content: center; color: #888;">
            No Image
          </div>
        {% endif %}

        <div style="padding: 16px; display: flex; flex-direction: column; flex-grow: 1;">
          <h5 style="font-size: 18px; font-weight: bold; margin-bottom: 10px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
            {{ article.title }}
          </h5>
          <p style="font-size: 14px; color: #555; margin-bottom: 15px; flex-grow: 1; overflow: hidden; text-overflow: ellipsis; max-height: 60px;">
            {{ article.overview }}
          </p>

          <a href="{{ article.link }}" target="_blank" 
             style="display: inline-block; text-align: center; padding: 8px; margin-bottom: 8px; border: 1px solid black; border-radius: 4px; text-decoration: none; font-size: 14px; color: black; transition: all 0.2s;">
            Read More
          </a>

          {% if article.show_save %}
            <a href="{% url 'save-article' %}?title={{ article.title|urlencode }}&desc={{ article.overview|urlencode }}&url={{ article.link|urlencode }}&img={{ article.pic|urlencode }}" 
               style="display: inline-block; text-align: center; padding: 8px; background: black; color: white; border-radius: 4px; text-decoration: none; font-size: 14px; font-weight: 500;">
               Save Article
            </a>
          {% endif %}
        </div>
      </div>
    {% empty %}
      <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: #888;">
        No articles available for your preferences.
      </div>
    {% endfor %}
  </div>
</div>

{% endblock %}

